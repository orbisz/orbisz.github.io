<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.19">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <link rel="icon" href="/favicon1.ico"><title>Netty学习总结 | orbisz-Blog</title><meta name="description" content="Carpe diem">
    <link rel="preload" href="/assets/style-BwPacOyM.css" as="style"><link rel="stylesheet" href="/assets/style-BwPacOyM.css">
    <link rel="modulepreload" href="/assets/app-ByLG9LQz.js"><link rel="modulepreload" href="/assets/Netty.html-CvNvs8gj.js">
    <link rel="prefetch" href="/assets/timeline.html-D8bL9X10.js" as="script"><link rel="prefetch" href="/assets/posts.html-BUKh4Xkh.js" as="script"><link rel="prefetch" href="/assets/friendship-link.html-B2BltZ8v.js" as="script"><link rel="prefetch" href="/assets/1.html-By_0A9C9.js" as="script"><link rel="prefetch" href="/assets/2.html-DNr8z5qN.js" as="script"><link rel="prefetch" href="/assets/3.html-BPcxeU9p.js" as="script"><link rel="prefetch" href="/assets/1.html-3PHRKLWU.js" as="script"><link rel="prefetch" href="/assets/1.html-DkVM-LuR.js" as="script"><link rel="prefetch" href="/assets/1.html-NS5LR8hY.js" as="script"><link rel="prefetch" href="/assets/1.html-C63klMuD.js" as="script"><link rel="prefetch" href="/assets/2.html-CPgYeXMJ.js" as="script"><link rel="prefetch" href="/assets/1.html-mMC7k61w.js" as="script"><link rel="prefetch" href="/assets/2.html-CJMtKSph.js" as="script"><link rel="prefetch" href="/assets/1.html-DBlSI2e4.js" as="script"><link rel="prefetch" href="/assets/1.html-DCSLntsV.js" as="script"><link rel="prefetch" href="/assets/1.html-DTLpyGl-.js" as="script"><link rel="prefetch" href="/assets/2.html-8A1WoTob.js" as="script"><link rel="prefetch" href="/assets/1.html-Bhsd_8Ma.js" as="script"><link rel="prefetch" href="/assets/1.html-BcEZH6QN.js" as="script"><link rel="prefetch" href="/assets/1.html-DUo9XIu7.js" as="script"><link rel="prefetch" href="/assets/1.html-aeCs_6R3.js" as="script"><link rel="prefetch" href="/assets/1.html-CLsRxVZA.js" as="script"><link rel="prefetch" href="/assets/1.html-CPflLrjL.js" as="script"><link rel="prefetch" href="/assets/1.html-BZQF61Kr.js" as="script"><link rel="prefetch" href="/assets/1.html-BuQ4vSn_.js" as="script"><link rel="prefetch" href="/assets/1.html-_RYSIzBN.js" as="script"><link rel="prefetch" href="/assets/1.html-vSegm2e1.js" as="script"><link rel="prefetch" href="/assets/1.html-C3gqmBSn.js" as="script"><link rel="prefetch" href="/assets/1.html-CsjAdv5i.js" as="script"><link rel="prefetch" href="/assets/1.html-ClKiFCJy.js" as="script"><link rel="prefetch" href="/assets/1.html-oL1sf9fB.js" as="script"><link rel="prefetch" href="/assets/1.html-BI_bNO4t.js" as="script"><link rel="prefetch" href="/assets/1.html-CqNXE2Q5.js" as="script"><link rel="prefetch" href="/assets/1.html-k1hb51ft.js" as="script"><link rel="prefetch" href="/assets/1.html-Y0qfODzV.js" as="script"><link rel="prefetch" href="/assets/1.html-CCOmfO_W.js" as="script"><link rel="prefetch" href="/assets/2.html-D9xEUk1-.js" as="script"><link rel="prefetch" href="/assets/1.html-BpKCwn5L.js" as="script"><link rel="prefetch" href="/assets/1.html-nkyid-Hd.js" as="script"><link rel="prefetch" href="/assets/1.html-Bmy6fa2j.js" as="script"><link rel="prefetch" href="/assets/1.html-COJM2PfY.js" as="script"><link rel="prefetch" href="/assets/1.html-C8ReidTp.js" as="script"><link rel="prefetch" href="/assets/2.html-TpnPJT_m.js" as="script"><link rel="prefetch" href="/assets/1.html-B3SgaIFv.js" as="script"><link rel="prefetch" href="/assets/1.html-CLI4rAg1.js" as="script"><link rel="prefetch" href="/assets/1.html-2u3e_Su1.js" as="script"><link rel="prefetch" href="/assets/1.html-DPL_yd3D.js" as="script"><link rel="prefetch" href="/assets/2.html-DbERg0Rh.js" as="script"><link rel="prefetch" href="/assets/1.html-CATswM7G.js" as="script"><link rel="prefetch" href="/assets/1.html-BHKdEpx2.js" as="script"><link rel="prefetch" href="/assets/1.html-3kCVGkdp.js" as="script"><link rel="prefetch" href="/assets/1.html-C5G71N1C.js" as="script"><link rel="prefetch" href="/assets/1.html-WVycvXvq.js" as="script"><link rel="prefetch" href="/assets/1.html-Bmy6fa2j.js" as="script"><link rel="prefetch" href="/assets/1.html-BaRIUcjq.js" as="script"><link rel="prefetch" href="/assets/1.html-riVy44zH.js" as="script"><link rel="prefetch" href="/assets/1.html-DoIiqL-S.js" as="script"><link rel="prefetch" href="/assets/1.html-rulaLow8.js" as="script"><link rel="prefetch" href="/assets/1.html-BaRIUcjq.js" as="script"><link rel="prefetch" href="/assets/1.html-DmxGrvk8.js" as="script"><link rel="prefetch" href="/assets/1.html-C0l0Jkzg.js" as="script"><link rel="prefetch" href="/assets/1.html-GBpwaCie.js" as="script"><link rel="prefetch" href="/assets/1.html-_82cBIMV.js" as="script"><link rel="prefetch" href="/assets/1.html-CWfgrjaY.js" as="script"><link rel="prefetch" href="/assets/1.html-CtezQova.js" as="script"><link rel="prefetch" href="/assets/1.html-Dd5NbL6R.js" as="script"><link rel="prefetch" href="/assets/1.html-B0V40mYZ.js" as="script"><link rel="prefetch" href="/assets/1.html-Coqjh3BA.js" as="script"><link rel="prefetch" href="/assets/1.html-pZpEnwGj.js" as="script"><link rel="prefetch" href="/assets/1.html-DQjz_ldM.js" as="script"><link rel="prefetch" href="/assets/1.html-UzeOju-U.js" as="script"><link rel="prefetch" href="/assets/1.html-DU1MhTdD.js" as="script"><link rel="prefetch" href="/assets/1.html-CYmx0txs.js" as="script"><link rel="prefetch" href="/assets/2.html-BJBEBjEZ.js" as="script"><link rel="prefetch" href="/assets/3.html-C6CfWmfx.js" as="script"><link rel="prefetch" href="/assets/4.html-Ukw6i0YW.js" as="script"><link rel="prefetch" href="/assets/5.html-CAZt63lh.js" as="script"><link rel="prefetch" href="/assets/6.html-DK4tGfxS.js" as="script"><link rel="prefetch" href="/assets/index.html-BYz3YNfS.js" as="script"><link rel="prefetch" href="/assets/message-board.html-BcDI9Zkh.js" as="script"><link rel="prefetch" href="/assets/1.html-B29hZLBO.js" as="script"><link rel="prefetch" href="/assets/2.html-CrQNYLf5.js" as="script"><link rel="prefetch" href="/assets/AI_Coding.html-BtfP7Fop.js" as="script"><link rel="prefetch" href="/assets/claude.html-B4XkvgU5.js" as="script"><link rel="prefetch" href="/assets/MCP.html-C5AAcB-0.js" as="script"><link rel="prefetch" href="/assets/Memory.html-C3yktRTr.js" as="script"><link rel="prefetch" href="/assets/paper1.html-_YcSspz0.js" as="script"><link rel="prefetch" href="/assets/Prompt.html-CvIZrWLt.js" as="script"><link rel="prefetch" href="/assets/RAG.html-Dvt9_VvF.js" as="script"><link rel="prefetch" href="/assets/transformer.html-BZy-WUhL.js" as="script"><link rel="prefetch" href="/assets/DevelopmentTips.html-sPVXWJ6z.js" as="script"><link rel="prefetch" href="/assets/DI.html-BBUdts9f.js" as="script"><link rel="prefetch" href="/assets/MVCC.html-DPWGTGXx.js" as="script"><link rel="prefetch" href="/assets/mysql.html-B-1wD3tc.js" as="script"><link rel="prefetch" href="/assets/RDBandAOF.html-BrbE_LMN.js" as="script"><link rel="prefetch" href="/assets/SpringBootStarter.html-v-qKlnoz.js" as="script"><link rel="prefetch" href="/assets/xitongshejitu.html-Bof_9_b0.js" as="script"><link rel="prefetch" href="/assets/yuanma.html-BCQPodmS.js" as="script"><link rel="prefetch" href="/assets/1.html-Br9DSheP.js" as="script"><link rel="prefetch" href="/assets/1.html-CcP5DXmW.js" as="script"><link rel="prefetch" href="/assets/2.html-Cm4dgxaI.js" as="script"><link rel="prefetch" href="/assets/3.html-w8dg-vrR.js" as="script"><link rel="prefetch" href="/assets/5.html-Bcef1yeB.js" as="script"><link rel="prefetch" href="/assets/graph.html-CMWK02fE.js" as="script"><link rel="prefetch" href="/assets/offer-java.html-DaXG1nfx.js" as="script"><link rel="prefetch" href="/assets/offer-java2.html-C6oKnrQY.js" as="script"><link rel="prefetch" href="/assets/offer-java3.html-tlhilY5a.js" as="script"><link rel="prefetch" href="/assets/paixu.html-BhIgkN9d.js" as="script"><link rel="prefetch" href="/assets/stackandheap.html-BAsHdm8E.js" as="script"><link rel="prefetch" href="/assets/tanxin.html-Bk3RTeJQ.js" as="script"><link rel="prefetch" href="/assets/union.html-BYK06_pi.js" as="script"><link rel="prefetch" href="/assets/2.html-BDRLyHub.js" as="script"><link rel="prefetch" href="/assets/OpenAI2025.html-C4v3A5bQ.js" as="script"><link rel="prefetch" href="/assets/DDD.html-DP-1YKBE.js" as="script"><link rel="prefetch" href="/assets/1.html-s1SVgBsH.js" as="script"><link rel="prefetch" href="/assets/docker.html-B3AxyQoO.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-DsKD7sz4.js" as="script"><link rel="prefetch" href="/assets/1.html-4OfMoKIH.js" as="script"><link rel="prefetch" href="/assets/code-review.html-0blJbOTz.js" as="script"><link rel="prefetch" href="/assets/1.html-C3we6iIC.js" as="script"><link rel="prefetch" href="/assets/IM.html-Dmny0O1g.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-Ckxkw3mS.js" as="script"><link rel="prefetch" href="/assets/one-api-sdk.html-C554EwZe.js" as="script"><link rel="prefetch" href="/assets/dayingxiao.html-CvzF91LB.js" as="script"><link rel="prefetch" href="/assets/dayingxiao1.html-BkE9kCui.js" as="script"><link rel="prefetch" href="/assets/dayingxiao2.html-C7nq8KqK.js" as="script"><link rel="prefetch" href="/assets/dayingxiao3.html-BrwNtLNp.js" as="script"><link rel="prefetch" href="/assets/dayingxiao4.html-BFTeAFH7.js" as="script"><link rel="prefetch" href="/assets/guide.html-1rgatwtb.js" as="script"><link rel="prefetch" href="/assets/1.html-KhhNp96o.js" as="script"><link rel="prefetch" href="/assets/2.html-BdjVFHml.js" as="script"><link rel="prefetch" href="/assets/3.html-DL9V897o.js" as="script"><link rel="prefetch" href="/assets/4.html-BNXZBfjk.js" as="script"><link rel="prefetch" href="/assets/4.html-Cxyn_WRa.js" as="script"><link rel="prefetch" href="/assets/5.html-skRFr1UF.js" as="script"><link rel="prefetch" href="/assets/wrench1.html-B0D5O5uC.js" as="script"><link rel="prefetch" href="/assets/wrench2.html-BG3zwCYI.js" as="script"><link rel="prefetch" href="/assets/wrench3.html-CGUz_RsK.js" as="script"><link rel="prefetch" href="/assets/404.html-Dj_9d147.js" as="script"><link rel="prefetch" href="/assets/Valine.min-_LyT3bfY.js" as="script"><link rel="prefetch" href="/assets/giscus-aTimukGI-DWEKOTfS.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><img class="logo" src="/logo1.jpg" alt="orbisz-Blog"><a href="/" class="site-name can-hide">orbisz-Blog</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/" class="link" aria-label="首页"><!--[--><!--]--><span class="xicon-container left"><!--[--><IconHome class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"></IconHome><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->首页<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/docs/message-board" class="link" aria-label="留言板"><!--[--><!--]--><span class="xicon-container left"><!--[--><IconChat class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"></IconChat><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->留言板<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a class="link" href="https://blog.csdn.net/hywzxy" target="_blank" rel="noopener noreferrer" aria-label="CSDN"><!--[--><!--]--><span class="xicon-container left"><!--[--><IconCSDN class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"></IconCSDN><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->CSDN<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a class="link" href="https://github.com/orbisz" target="_blank" rel="noopener noreferrer" aria-label="Github"><!--[--><!--]--><span class="xicon-container left"><!--[--><IconGithub class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"></IconGithub><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Github<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="项目体验"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->项目体验<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="项目体验"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->项目体验<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a class="link" href="http://117.72.164.204:3000/?userId=zxy&amp;activityId=100301" target="_blank" rel="noopener noreferrer" aria-label="幸运营销汇"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->幸运营销汇<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a class="link" href="http://101.43.191.204" target="_blank" rel="noopener noreferrer" aria-label="Ai-Agent 智能体 "><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Ai-Agent 智能体 <!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><div class="theme-main" style=""><!----><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">Netty学习总结</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->orbisz<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2025/04/24<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/categories/houduanxuexi/1.html" class="">后端学习</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/tags/kuangjia/1.html" class="">框架</a><a href="/tags/Netty/1.html" class="">Netty</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;font-size:18px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 12 12"><g fill="none"><path d="M1.974 6.659a.5.5 0 0 1-.948-.317c-.01.03 0-.001 0-.001a1.633 1.633 0 0 1 .062-.162c.04-.095.099-.226.18-.381c.165-.31.422-.723.801-1.136C2.834 3.827 4.087 3 6 3c1.913 0 3.166.827 3.931 1.662a5.479 5.479 0 0 1 .98 1.517l.046.113c.003.008.013.06.023.11L11 6.5s.084.333-.342.474a.5.5 0 0 1-.632-.314v-.003l-.006-.016a3.678 3.678 0 0 0-.172-.376a4.477 4.477 0 0 0-.654-.927C8.584 4.673 7.587 4 6 4s-2.584.673-3.194 1.338a4.477 4.477 0 0 0-.795 1.225a2.209 2.209 0 0 0-.03.078l-.007.018zM6 5a2 2 0 1 0 0 4a2 2 0 0 0 0-4zM5 7a1 1 0 1 1 2 0a1 1 0 0 1-2 0z" fill="currentColor"></path></g></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><span id="/blogs/backend/Netty/Netty.html" class="leancloud-visitors" data-flag-title="Your Article Title"><a class="leancloud-visitors-count" style=""></a></span><!----><!--]--></span></span></div><div class="theme-reco-md-content"><div><p>Netty基于NIO，使用Netty可以极大地简化TCP和UDP套接字服务器等网络编程，提供高性能、可扩展的网络应用解决方案，并且性能以及安全性等方面都比较优秀。 我们平常接触到的Dubbo、RocketMQ、Elasticsearch、gRPC、Spark等热门开源项目都用到了Netty。 大部分微服务框架底层涉及到网络通信的部分都是基于Netty来做的，比如Spring Cloud生态系统中的网关Spring Cloud Gateway。</p><h2 id="nio、bio和aio的区别" tabindex="-1"><a class="header-anchor" href="#nio、bio和aio的区别"><span>NIO、BIO和AIO的区别</span></a></h2><p><img src="/assets/1-Dl12_UJA.png" alt=""></p><h3 id="bio" tabindex="-1"><a class="header-anchor" href="#bio"><span>BIO</span></a></h3><p>BIO属于<strong>同步阻塞</strong>模型，数据的读取写入必须阻塞在一个线程内等待其完成。 <img src="/assets/2-DxVkp9wM.png" alt=""> 在客户端连接数量不高的情况下，是没问题的。但当面对十万甚至百万级连接时，需要一种更高效得I/O处理模型来应对更高的并发量。</p><h3 id="nio" tabindex="-1"><a class="header-anchor" href="#nio"><span>NIO</span></a></h3><p><strong>同步非阻塞模型</strong><img src="/assets/3--d3vDEkQ.png" alt=""> 同步非阻塞模型中，应用程序会已知发起<code>read</code>调用，等待数据准备就绪，再从内核空间拷贝到用户空间（这段时间线程仍然是阻塞的）。 同步非阻塞IO模型通过轮询操作，避免了一直阻塞。但同样存在问题：应用程序不断进行I/O系统调用轮询数据是否已经准备好的过程是非常消耗CPU资源的。</p><p><strong>I/O多路复用模型</strong><img src="/assets/4-DR4CbuST.png" alt=""> 线程首先发起<code>select</code>调用，询问内核数据是否准备就绪，等内核准备好数据了，用户线程再发起<code>read</code>调用（该过程仍然是阻塞的）。 I/O多路复用模型通过减少无效的系统调用，减少对CPU资源的消耗。I/O多路复用有一个重要的选择器概念，被称为多路复用器。 通过它，只需要一个线程就可以管理多个客户端连接</p><h3 id="aio" tabindex="-1"><a class="header-anchor" href="#aio"><span>AIO</span></a></h3><p>异步IO是基于事件和回调机制实现的，即应用操作之后会直接返回，不会阻塞在那。等后台处理完毕，操作系统会通知相应的线程进行后续的操作。</p><h2 id="netty是什么-为什么要用netty-不直接用nio呢" tabindex="-1"><a class="header-anchor" href="#netty是什么-为什么要用netty-不直接用nio呢"><span>Netty是什么，为什么要用Netty，不直接用NIO呢？</span></a></h2><ul><li>Netty是一个基于NIO的客户端服务器框架，使用它可以快速简单的开发网络应用程序</li><li>它极大的简化并优化了TCP和UDP套接字服务器等网络编程，并且性能和安全性等很多方面甚至都要更好。</li><li>支持多种协议，如FTP、SMTP、HTTP以及各种二进制和基于文本的传统协议。 总的来说：Netty成功找到了一种在不妥协性能和可维护性的情况下实现易于开发、性能、稳定性和灵活性的方法。</li></ul><p>NIO的编程模型复杂并且存在一些BUG对编程的功底要求较高，而且NIO在面对断连重连、包丢失、粘包等问题时处理过程非常复杂，Netty的出现正是为了解决这些问题。</p><p>Netty的优点：</p><ul><li>统一的API，支持阻塞和非阻塞</li><li>简单而强大的线程模型</li><li>自带编码器解决TCP粘包/拆包问题</li><li>自带各种协议栈</li><li>真正的无连接数据包套接字支持</li><li>比直接用Java核心API有更高的吞吐量、更低的延迟、更低的资源消耗和更少的内存复制</li><li>安全性不错，有完整的SSL/TLS以及StartTLS支持。</li><li>社区活跃</li><li>成熟稳定，经历了大型项目的使用和考验，很多开源项目都使用到了Netty。</li></ul><h2 id="netty的应用场景" tabindex="-1"><a class="header-anchor" href="#netty的应用场景"><span>Netty的应用场景</span></a></h2><p>理论上，NIO可以做的事情，Netty都可以做并且可以做的更好。Netty主要用来做网络通信</p><ul><li>作为RPC框架的网络通信工具：在分布式系统中，需要RPC框架来完成不同服务节点之间的相互调用。Netty可以实现不同服务节点的通信。</li><li>实现一个自己的HTTP服务器：通过Netty可以实现一个简单的HTTP服务器</li><li>实现一个即时通讯系统</li><li>实现消息推送</li></ul><h2 id="netty的核心组件及作用" tabindex="-1"><a class="header-anchor" href="#netty的核心组件及作用"><span>Netty的核心组件及作用</span></a></h2><p><img src="/assets/6-CplFGwO5.png" alt=""></p><h3 id="bytebuf-字节容器" tabindex="-1"><a class="header-anchor" href="#bytebuf-字节容器"><span>ByteBuf(字节容器)</span></a></h3><p>网络通信是通过字节流进行传输的。<code>ByteBuf</code>就是Netty提供的一个字节容器，内部是一个字节数组，Netty传输数据时，也是通过该组件进行。 我们可以将<code>ByteBuf</code>看作Netty对Java NIO提供了<code>ByteBuffer</code>字节容器的封装和抽象。</p><h3 id="bootstrap和serverbootstrap-启动引导类" tabindex="-1"><a class="header-anchor" href="#bootstrap和serverbootstrap-启动引导类"><span>Bootstrap和ServerBootstrap(启动引导类)</span></a></h3><p><code>Bootstrap</code>是客户端的启动引导类/辅助类，<code>ServerBootstrap</code>是服务端的启动引导类/辅助类</p><ul><li><code>Bootstrap</code>通常使用<code>connect()</code>方法连接到远程的主机和端口，作为一个Netty TCP协议通信中的客户端。还可以通过<code>bind()</code>方法绑定本地的一个端口，作为UDP协议通信的一段。</li><li><code>ServerBootstrap</code>通常使用<code>bind()</code>绑定在本地端口，等待客户端的连接。</li><li><code>Bootstrap</code>只需要配置一个线程组-<code>EventLoopGroup</code>，而<code>ServerBootstrap</code>需要配置两个线程组-<code>EventLoopGroup</code>，一个用于接收连接，一个用于具体的IO处理。</li></ul><h3 id="channel-网络操作抽象类" tabindex="-1"><a class="header-anchor" href="#channel-网络操作抽象类"><span>Channel(网络操作抽象类)</span></a></h3><p><code>Channel</code>接口是Netty对网络操作抽象类，通过<code>Channel</code>我们可以进行I/O操作。比较常用的<code>Channel</code>接口实现类有<code>NioServerSocketChannel</code>(服务端)和<code>NioSocketChannel</code>(客户端)。</p><h3 id="eventloop-事件循环" tabindex="-1"><a class="header-anchor" href="#eventloop-事件循环"><span>EventLoop(事件循环)</span></a></h3><p>主要作用就是责监听网络事件并调用事件处理器进行相关I/O操作（读写）的处理。</p><p><code>Channel</code>为Netty网络操作（读写等操作）抽象类，<code>EventLoop</code>负责处理注册到其上的<code>Channel</code>的I/O操作，两者配合进行I/O操作.</p><p><code>EventLoopGroup</code>包含多个<code>EventLoop</code>（每一个EventLoop通常内部包含一个线程），它管理所有的<code>EventLoop</code>的生命周期。<code>EventLoop</code>处理的I/O事件都将在它专有的<code>Thread</code>上被处理，即<code>Thread</code>和<code>EventLoop</code>属于1:1的关系，从而保证线程安全。</p><p><img src="/assets/7-Bys_7F_n.png" alt=""></p><h3 id="channelhandler-消息处理器-和channelpipeline-channelhandler对象链表" tabindex="-1"><a class="header-anchor" href="#channelhandler-消息处理器-和channelpipeline-channelhandler对象链表"><span>ChannelHandler(消息处理器)和ChannelPipeline(ChannelHandler对象链表)</span></a></h3><p><code>ChannelHandler</code>是消息的具体处理器，主要负责处理客户端/服务端接收和发送的数据。 当<code>Channel</code>被创建时，它会被自动分配到它专属的<code>ChannelPipeline</code>。一个<code>Channel</code>包含一个<code>ChannelPipeline</code>。<code>ChannelPipeline</code>为<code>ChannelHandler</code>的链，一个<code>pipeline</code>上可以有多个<code>ChannelHandler</code>。</p><h3 id="channelfuture-操作执行结果" tabindex="-1"><a class="header-anchor" href="#channelfuture-操作执行结果"><span>ChannelFuture(操作执行结果)</span></a></h3><p>Netty中所有的I/O操作都是异步的，因此不能立刻得到操作是否执行成功。可以通过<code>ChannelFuture</code>接口的<code>addListener()</code>方法注册一个<code>ChannelFutureListener</code>，当操作执行成功或者失败，监听就会自动触发返回结果。 <code>channel()</code>方法获取连接相关联的<code>Channel</code>。<code>sync()</code>方法让异步操作变成同步的。</p><h2 id="nioeventloopgroup默认的构造函数会起多少线程" tabindex="-1"><a class="header-anchor" href="#nioeventloopgroup默认的构造函数会起多少线程"><span>NioEventLoopGroup默认的构造函数会起多少线程?</span></a></h2><p><strong>CPU核心数*2</strong></p><h2 id="reactor线程模型" tabindex="-1"><a class="header-anchor" href="#reactor线程模型"><span>Reactor线程模型</span></a></h2><p>Reactor是一种经典的线程模型，基于事件驱动，采用多路复用将事件分发给相应的<code>Handler</code>处理，适合处理海量的I/O事件。</p><h3 id="单线程reactor" tabindex="-1"><a class="header-anchor" href="#单线程reactor"><span>单线程Reactor</span></a></h3><p>所有的IO操作都由同一个NIO线程处理。</p><p>系统资源消耗小，不支持大量请求的应用场景并且处理请求的时间比较慢。</p><h3 id="多线程reactor" tabindex="-1"><a class="header-anchor" href="#多线程reactor"><span>多线程Reactor</span></a></h3><p>一个线程负责接受请求，一组NIO线程负责处理IO操作。</p><p>在并发连接数比较多的场景下会存在性能问题。</p><h3 id="主从多线程reactor" tabindex="-1"><a class="header-anchor" href="#主从多线程reactor"><span>主从多线程Reactor</span></a></h3><p>一组NIO线程负责接收请求，一组NIO线程负责处理IO操作。</p><h2 id="netty线程模型" tabindex="-1"><a class="header-anchor" href="#netty线程模型"><span>Netty线程模型</span></a></h2><p>大部分网络框架都基于Reactor模式设计开发。Netty主要靠<code>NioEventLoopGroup</code>线程池来实现线程模型。 在实现服务端时，一般会初始化两个数组</p><ul><li><code>bossGroup</code>：接收连接</li><li><code>workerGroup</code>：负责具体的处理，交由对应的Handler处理</li></ul><h3 id="单线程模型" tabindex="-1"><a class="header-anchor" href="#单线程模型"><span>单线程模型</span></a></h3><p>一个线程单独处理客户端连接以及I/O读写，涉及到<code>accept</code>、<code>read</code>、<code>decode</code>、<code>process</code>、<code>encode</code>、<code>send</code>等事件。不适用高并发、高负载和性能要求较高的场景。</p><h3 id="多线程模型" tabindex="-1"><a class="header-anchor" href="#多线程模型"><span>多线程模型</span></a></h3><p>一个Acceptor线程只负责监听客户端的连接，一个NIO线程池负责处理I/O读写。 在并发连接大的时候会出现性能瓶颈。</p><h3 id="主从线程模型" tabindex="-1"><a class="header-anchor" href="#主从线程模型"><span>主从线程模型</span></a></h3><p>从一个主线程NIO线程池中选择一个线程作为Acceptor线程，绑定监听端口，接收客户端连接，其他线程负责后续的接入认证工作，建立完连接后，Sub NIO线程池负责具体处理I/O读写。</p><h2 id="netty服务端和客户端的启动流程" tabindex="-1"><a class="header-anchor" href="#netty服务端和客户端的启动流程"><span>Netty服务端和客户端的启动流程</span></a></h2><h3 id="服务端" tabindex="-1"><a class="header-anchor" href="#服务端"><span>服务端</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token comment">// 1.md.bossGroup 用于接收连接，workerGroup 用于具体的处理</span></span>
<span class="line"><span class="token class-name">EventLoopGroup</span> bossGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token number">1.</span>md<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token class-name">EventLoopGroup</span> workerGroup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token comment">//2.创建服务端启动引导/辅助类：ServerBootstrap</span></span>
<span class="line"><span class="token class-name">ServerBootstrap</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//3.给引导类配置两大线程组,确定了线程模型</span></span>
<span class="line">b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>bossGroup<span class="token punctuation">,</span> workerGroup<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// (非必备)打印日志</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LoggingHandler</span><span class="token punctuation">(</span><span class="token class-name">LogLevel</span><span class="token punctuation">.</span><span class="token constant">INFO</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// 4.指定 IO 模型</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token class-name">NioServerSocketChannel</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelInitializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketChannel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token annotation punctuation">@Override</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initChannel</span><span class="token punctuation">(</span><span class="token class-name">SocketChannel</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token class-name">ChannelPipeline</span> p <span class="token operator">=</span> ch<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//5.可以自定义客户端消息的业务处理逻辑</span></span>
<span class="line">p<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HelloServerHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 6.绑定端口,调用 sync 方法阻塞知道绑定完成</span></span>
<span class="line"><span class="token class-name">ChannelFuture</span> f <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 7.阻塞等待直到服务器Channel关闭(closeFuture()方法获取Channel 的CloseFuture对象,然后调用sync()方法)</span></span>
<span class="line">f<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">closeFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token comment">//8.优雅关闭相关线程组资源</span></span>
<span class="line">bossGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">workerGroup<span class="token punctuation">.</span><span class="token function">shutdownGracefully</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>创建两个<code>NioEventLoopGroup</code>对象实例： <ul><li><code>bossGroup</code>：处理客户端的TCP连接请求</li><li><code>workerGroup</code>：负责每一条连接的具体读写数据的处理逻辑，真正负责I/O读写操作，交由对应的Handler处理。</li></ul></li><li>创建一个服务端启动引导/辅助类，引导进行服务端的启动工作。</li><li>通过<code>group()</code>方法给引导类<code>ServerBootstrap</code>配置两大线程组，确定了线程模型。</li><li>通过<code>channel()</code>方法给引导类<code>ServetBootstrap</code>指定了IO模型为NIO <ul><li><code>NioServerSocketChannel</code>：指定服务端的IO模型为NIO，与BIO编程模型中的ServerSocket对应</li><li><code>NioSocketChannel</code>：指定客户端的IO模型为NIO，与BIO编程模型中的Socket对应。</li></ul></li><li>通过<code>childHandler()</code>方法给引导类创建一个<code>ChannelInitializer</code>，然后指定服务端消息的业务处理逻辑<code>HelloServerHandler</code>对象。</li><li>调用<code>ServerBootstrap</code>类的<code>bind()</code>方法绑定端口。</li></ol><h3 id="客户端" tabindex="-1"><a class="header-anchor" href="#客户端"><span>客户端</span></a></h3><div class="language-Java line-numbers-mode" data-highlighter="prismjs" data-ext="Java" data-title="Java"><pre><code><span class="line">    //1.md.创建一个 NioEventLoopGroup 对象实例</span>
<span class="line">    EventLoopGroup group = new NioEventLoopGroup();</span>
<span class="line">    try {</span>
<span class="line">        //2.创建客户端启动引导/辅助类：Bootstrap</span>
<span class="line">        Bootstrap b = new Bootstrap();</span>
<span class="line">        //3.指定线程组</span>
<span class="line">        b.group(group)</span>
<span class="line">                //4.指定 IO 模型</span>
<span class="line">                .channel(NioSocketChannel.class)</span>
<span class="line">                .handler(new ChannelInitializer&lt;SocketChannel&gt;() {</span>
<span class="line">                    @Override</span>
<span class="line">                    public void initChannel(SocketChannel ch) throws Exception {</span>
<span class="line">                        ChannelPipeline p = ch.pipeline();</span>
<span class="line">                        // 5.这里可以自定义消息的业务处理逻辑</span>
<span class="line">                        p.addLast(new HelloClientHandler(message));</span>
<span class="line">                    }</span>
<span class="line">                });</span>
<span class="line">        // 6.尝试建立连接</span>
<span class="line">        ChannelFuture f = b.connect(host, port).sync();</span>
<span class="line">        // 7.等待连接关闭（阻塞，直到Channel关闭）</span>
<span class="line">        f.channel().closeFuture().sync();</span>
<span class="line">    } finally {</span>
<span class="line">        group.shutdownGracefully();</span>
<span class="line">    }</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>调用<code>Bootstrap</code>类的<code>connect()</code>方法进行连接，需要指定两个参数：<code>inetHost</code>：ip地址，<code>inetPort</code>：端口号</li></ol><h2 id="什么是tcp粘包-拆包-有什么解决方法" tabindex="-1"><a class="header-anchor" href="#什么是tcp粘包-拆包-有什么解决方法"><span>什么是TCP粘包/拆包？有什么解决方法</span></a></h2><p><strong>粘包</strong>：多个独立的应用层消息被合并成一个 TCP 数据包传输，接收端无法直接区分原始消息边界。 <strong>拆包</strong>：一个应用层消息被分割成多个 TCP 数据包传输，接收端需要将多个包重组为完整消息。</p><p>解决方法：</p><p>1.<strong>使用Netty自带的解码器</strong></p><ul><li><code>LineBasedFrameDecoder</code>：依次遍历<code>ByteBuf</code>中的可读字节，判断是否有换行符，然后进行截取。</li><li><code>DelimiterBasedFrameDecoder</code>：可以自定义分隔符解码器。</li><li><code>FixedLengthFrameDecoder</code>：固定长度解码器，按照指定的长度进行拆包，长度不够，则空格补全。</li><li><code>LengthFieldBasedFrameDecoder</code>：长度域解码器，根据发送的数据中消息长度相关参数（长度域偏移量）来进行拆包。 2.<strong>自定义序列化偏移量</strong></li></ul><p>Java自带有实现<code>Serializable</code>接口来实现序列化，不过由于性能、安全性等原因一般不用。</p><p><code>Protostuff</code>、<code>Hessian2</code>、<code>json</code>序列方式比较多，还有专门针对Java的<code>Kryo</code>、<code>FST</code>等，跨语言的<code>Protostuff</code>，<code>ProtoBuf</code>等。</p><h2 id="netty长连接、心跳机制" tabindex="-1"><a class="header-anchor" href="#netty长连接、心跳机制"><span>Netty长连接、心跳机制</span></a></h2><h3 id="tcp长连接、短连接" tabindex="-1"><a class="header-anchor" href="#tcp长连接、短连接"><span>TCP长连接、短连接</span></a></h3><p>短连接：服务端与客户端建立连接后，读写完成后就关闭连接，如果要再次发送消息，就要重新连接。 长连接：客户端向服务端建立连接后，不会主动关闭，后续的读写操作还是会继续使用这个连接。</p><h3 id="为什么需要心跳机制-netty的心跳机制" tabindex="-1"><a class="header-anchor" href="#为什么需要心跳机制-netty的心跳机制"><span>为什么需要心跳机制？Netty的心跳机制</span></a></h3><p>在TCP保持长连接的过程中，可能会出现断网等异常情况，当异常发生时，客户端和服务端之间如果没有交互，无法发现对方已经掉线，因此为了解决这个问题，就需要引入心跳机制。</p><p>心跳机制的工作原理：在客户端和服务端之间在一定时间内没有数据交互时，客户端或服务端就会发送一个特殊的服务包给对方，当接收方收到这个数据报文时，也会发送一个特殊的数据报文，回应发送方，这就是一个PING-PONG交互。</p><p>TCP自带的长连接选项本身就有心跳机制：<code>SO_KEEPLIVE</code>，但不够灵活。因此一般都是在应用层协议上实现自定义心跳机制。通过Netty实现心跳机制的核心类是：<code>IdleStateHandler</code>。</p><p>参考文章： <a href="https://javaguide.cn/java/io/io-model.html#nio-non-blocking-new-i-o" target="_blank" rel="noopener noreferrer">Java IO 模型详解<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->最近更新 2025/8/8 21:24:49<!--]--></span></span></div></footer><!----><div class="reco-valine-wrapper"><div id="valine"></div></div></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#nio、bio和aio的区别" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="NIO、BIO和AIO的区别"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->NIO、BIO和AIO的区别<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#bio" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="BIO"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->BIO<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#nio" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="NIO"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->NIO<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#aio" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="AIO"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->AIO<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#netty是什么-为什么要用netty-不直接用nio呢" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Netty是什么，为什么要用Netty，不直接用NIO呢？"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Netty是什么，为什么要用Netty，不直接用NIO呢？<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#netty的应用场景" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Netty的应用场景"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Netty的应用场景<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#netty的核心组件及作用" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Netty的核心组件及作用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Netty的核心组件及作用<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#bytebuf-字节容器" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ByteBuf(字节容器)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->ByteBuf(字节容器)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#bootstrap和serverbootstrap-启动引导类" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Bootstrap和ServerBootstrap(启动引导类)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Bootstrap和ServerBootstrap(启动引导类)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#channel-网络操作抽象类" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Channel(网络操作抽象类)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Channel(网络操作抽象类)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#eventloop-事件循环" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="EventLoop(事件循环)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->EventLoop(事件循环)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#channelhandler-消息处理器-和channelpipeline-channelhandler对象链表" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ChannelHandler(消息处理器)和ChannelPipeline(ChannelHandler对象链表)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->ChannelHandler(消息处理器)和ChannelPipeline(ChannelHandler对象链表)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#channelfuture-操作执行结果" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="ChannelFuture(操作执行结果)"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->ChannelFuture(操作执行结果)<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#nioeventloopgroup默认的构造函数会起多少线程" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="NioEventLoopGroup默认的构造函数会起多少线程?"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->NioEventLoopGroup默认的构造函数会起多少线程?<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#reactor线程模型" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Reactor线程模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Reactor线程模型<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#单线程reactor" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="单线程Reactor"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->单线程Reactor<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#多线程reactor" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="多线程Reactor"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->多线程Reactor<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#主从多线程reactor" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="主从多线程Reactor"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->主从多线程Reactor<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#netty线程模型" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Netty线程模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Netty线程模型<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#单线程模型" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="单线程模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->单线程模型<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#多线程模型" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="多线程模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->多线程模型<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#主从线程模型" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="主从线程模型"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->主从线程模型<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#netty服务端和客户端的启动流程" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Netty服务端和客户端的启动流程"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Netty服务端和客户端的启动流程<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#服务端" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="服务端"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->服务端<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#客户端" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="客户端"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->客户端<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#什么是tcp粘包-拆包-有什么解决方法" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="什么是TCP粘包/拆包？有什么解决方法"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->什么是TCP粘包/拆包？有什么解决方法<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#netty长连接、心跳机制" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Netty长连接、心跳机制"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Netty长连接、心跳机制<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#tcp长连接、短连接" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="TCP长连接、短连接"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->TCP长连接、短连接<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/backend/Netty/Netty.html#为什么需要心跳机制-netty的心跳机制" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="为什么需要心跳机制？Netty的心跳机制"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->为什么需要心跳机制？Netty的心跳机制<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-ByLG9LQz.js" defer></script>
  </body>
</html>
